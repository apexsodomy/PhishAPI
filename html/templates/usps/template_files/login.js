$(document).ready(function(){$(function(){$('[data-toggle="popover"]').popover({container:"body",trigger:"focus hover",placement:"top",html:true,content:popoverContent});});$("#username").keypress(function(a){if(a.which==13){$("#btn-submit").trigger("click");}});$("#password").keypress(function(a){if(a.which==13){$("#btn-submit").trigger("click");
}});$("#tPasswordRetype").keypress(function(a){if(a.which==13){$("#btn-continue").trigger("click");}});$("#btn-submit").on("click",function(c){c.preventDefault();clearInterval(tm);$("#response-msg").empty();$("span[id^=sr-only-error-]").empty();$("#sign-in-wrap span.error-txt").empty();$("#sign-in-wrap div.form-group").removeClass("has-error");
$(this).blur();$("#tPasswordNew").val("");$("#tPasswordRetype").val("");var a=$(this);if(!a.hasClass("disabled")){$.blockUI();a.prop("disabled",true).addClass("disabled");var b={username:$("#username").val(),password:$("#password").val(),newPassword:"",retypeNewPassword:""};authenticateUsrCredentials(b,function(d){switch(d.status){case"success":$("#loginForm").submit();
break;case"SQSA":$("#route").val(d.status);$("#loginForm").submit();break;case"REQUIRED":$("#row-1").addClass("hidden");$("#row-2").removeClass("hidden");$("#password-change-required").removeClass("hidden");$("#password-change-expired").addClass("hidden");$("#sign-in-to-your-account-header").addClass("hidden");
$("#change-your-password-header").removeClass("hidden");$("#btn-submit").prop("disabled",false).removeClass("disabled");$.unblockUI();break;case"EXPIRED":$("#row-1").addClass("hidden");$("#row-2").removeClass("hidden");$("#password-change-expired").removeClass("hidden");$("#password-change-required").addClass("hidden");
$("#sign-in-to-your-account-header").addClass("hidden");$("#change-your-password-header").removeClass("hidden");$("#btn-submit").prop("disabled",false).removeClass("disabled");$.unblockUI();break;case"PASSWORD":$("#route").val(d.status);$("#loginForm").submit();break;default:var e=[];$.each(d.errors,function(g,f){if(f.hasOwnProperty("field")){$("#form-group-"+f.field).addClass("has-error");
$("#sr-only-error-"+f.field).append(sanitizeHtmlOut(f.message));$("#error-"+f.field).append('<span class="error-txt-blk"><span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span> '+sanitizeHtmlOut(f.message)+"</span>");}else{if(f.hasOwnProperty("action")){millis=f.action;tm=setInterval(function(){millis-=1000;
if(millis<1000){$("#response-msg").empty();clearInterval(tm);}else{displayLockoutTimer();}},1000);e.push('<div class="error-txt"><span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span> Your account has been temporarily disabled. Please try again in <span id="remaining"></span></div>');
}else{e.push('<div class="error-txt"><span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span> '+sanitizeHtmlOut(f.message)+"</div>");}}});if(e.length>0){$("#response-msg").html(e.join(""));}$("#btn-submit").prop("disabled",false).removeClass("disabled");$.unblockUI();}});}});$("#btn-back").on("click",function(a){a.preventDefault();
$("#password-change-wrap :input").val("");$("#password-change-wrap div.form-group").removeClass("has-error");$("#response-change-msg").empty();$("#change-your-password-header").addClass("hidden");$("#row-2").addClass("hidden");$("#sign-in-to-your-account-header").removeClass("hidden");$("#row-1").removeClass("hidden");
});$("#btn-continue").on("click",function(c){c.preventDefault();$("#response-change-msg").empty();var d=false;if($("#tPasswordRetype").val()==""||$("#form-group-tPasswordRetype").hasClass("has-error")){$("#form-group-tPasswordRetype").addClass("has-error");d=true;$("#tPasswordRetype").focus();}if($("#tPasswordNew").val()==""||$("#form-group-tPasswordNew").hasClass("has-error")){$("#form-group-tPasswordNew").addClass("has-error");
d=true;$("#tPasswordNew").focus();}var a=$(this);if(!a.hasClass("disabled")&&!d){$.blockUI();a.prop("disabled",true).addClass("disabled");var b={username:$("#username").val(),password:$("#password").val(),newPassword:$("#tPasswordNew").val(),retypeNewPassword:$("#tPasswordRetype").val()};authenticateUsrCredentials(b,function(e){switch(e.status){case"success":$("#loginForm").submit();
break;case"SQSA":$("#route").val(e.status);$("#loginForm").submit();break;case"REQUIRED":$("#row-1").addClass("hidden");$("#row-2").removeClass("hidden");$("#btn-continue").prop("disabled",false).removeClass("disabled");$.unblockUI();break;case"EXPIRED":$("#row-1").addClass("hidden");$("#row-2").removeClass("hidden");
$("#btn-continue").prop("disabled",false).removeClass("disabled");$.unblockUI();break;case"PASSWORD":$("#route").val(e.status);$("#loginForm").submit();break;default:var f=[];$.each(e.errors,function(h,g){f.push('<div class="error-txt"><span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span> '+sanitizeHtmlOut(g.message)+"</div>");
});$("#response-change-msg").html(f.join(""));$("#btn-continue").prop("disabled",false).removeClass("disabled");$.unblockUI();}});}});$("#tPasswordNew").popover({content:function(){return $("#popover_content_wrapper").html();},placement:"bottom",trigger:"manual",html:true,"template":'<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>'});
$("#tPasswordNew").on("keydown",function(){$("#form-group-tPasswordNew").removeClass("has-error");}).on("keyup",function(a){a.stopImmediatePropagation();ValidatePassword($(this));}).on("focus",function(){ValidatePassword($(this));$("#tPasswordNew").popover("show");}).on("blur",function(){$(this).popover("hide");
if($("#tPasswordNew").val()==""){$("#form-group-tPasswordNew").addClass("has-error");}else{var a={};a["fieldToValidate"]=$(this).attr("name");a[$(this).attr("name")]=$(this).val();validateFieldMapJSON(a,false,function(b){if(b.status!="success"){$("#form-group-tPasswordNew").addClass("has-error");}});
}}).on("focusout",function(){passwordRetypeField=$("#tPasswordRetype");pwd2=passwordRetypeField.val();if(($(this).val().length>0)&&(pwd2.length==0)){}else{if($(this).val().length==0){}else{if($(this).val()==pwd2){$("#form-group-tPasswordNew").removeClass("has-error");}else{$("#form-group-tPasswordNew").addClass("has-error");
}}}});$("#tPasswordRetype").popover({content:function(){return $("#popover_content_wrapper_retype").html();},placement:"bottom",trigger:"manual",html:true,"template":'<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>'});$("#tPasswordRetype").on("keydown",function(){$("#form-group-tPasswordRetype").removeClass("has-error");
}).on("keyup",function(a){a.stopImmediatePropagation();ValidateRetypePassword($(this),$("#tPasswordNew"));}).on("focus",function(){ValidateRetypePassword($(this),$("#tPasswordNew"));$("#tPasswordRetype").popover("show");}).on("blur",function(){$(this).popover("hide");}).on("focusout",function(){pwd2=$("#tPasswordRetype").val();
if($("#form-group-tPasswordNew").hasClass("has-error")||pwd2.length==0){$("#form-group-tPasswordRetype").addClass("has-error");}else{if($("#tPasswordNew").val()==pwd2){$("#form-group-tPasswordRetype").removeClass("has-error");}else{$("#form-group-tPasswordRetype").addClass("has-error");}}});});