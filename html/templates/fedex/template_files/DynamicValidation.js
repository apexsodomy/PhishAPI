var loginId,password,retypepassword,reminderQuestion,reminderAnswer,address1;var Zip,State,firstName,lastName,City,Phone,Email,retypeEmail,country=true;var serverErrors=0;var acceptdisable;function validateUserId(theField){var errorcounter=0;var checkOK="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var id=$F('uid');var allValid=true;var ch;checkAllErrors();if(id==null||id.length<6){Element.show("idempty");addWSSError("empty userid");errorcounter++}else if(id!=null){for(i=0;i<id.length;i++){ch=id.charAt(i);if(isLetterOrDigit(ch)==false){allValid=false}}}if(!allValid){Element.show("idinvalid");addWSSError("invalid userid");errorcounter++}if(errorcounter>0){loginId=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}return(false)}else{Element.hide("idinvalid");Element.hide("idempty");loginId=true;accept();return(true)}}function validatePwd(theField){var foundAtRate=false;var foundDot=false;var foundSplChar=false;var found4SameChar=false;var foundLetter=false;var foundDigit=false;var pwd=$F('password');var pwdlength=pwd.length;var company=$F('company');var email=$F('email');var firstName=$F('firstName');var lastName=$F('lastName');var login=$F('uid');var retypepwd=$F('retypePassword');var errorcounter=0;checkAllErrors();Element.hide("required");if(pwdlength>0){for(i=0;i<pwdlength;i++){ch=pwd.charAt(i);if(isLetter(ch)){foundLetter=true}else if(isDigit(ch)){foundDigit=true}if(!isLetter(ch)&&!isDigit(ch)){if(ch=='@'){foundAtRate=true}else if(ch=='.'){foundDot=true}else if(ch==' '){foundSplChar=true}else if(ch=='~'){foundSplChar=true}else if(ch=='\''){foundSplChar=true}else if(ch=='"'){foundSplChar=true}}if(i>=3&&!found4SameChar){if((ch==pwd.charAt(i-1))&&(ch==pwd.charAt(i-2))&&(ch==pwd.charAt(i-3))){found4SameChar=true}}}}if((pwdlength>0&&pwdlength<6)||pwdlength<1){Element.show("pwdless");addWSSError("empty password");errorcounter++}else{Element.hide("pwdless")}if(pwdlength>35){Element.show("pwdlength");addWSSError("invalid password");errorcounter++}else{Element.hide("pwdlength")}if(!foundDigit||!foundLetter){Element.show("alpha");addWSSError("alpha password");errorcounter++}else{Element.hide("alpha")}if(foundSplChar){Element.show("charspecial");addWSSError("spchars password");errorcounter++}else{Element.hide("charspecial")}if(found4SameChar){Element.show("mrconschar");addWSSError("invalidchars password");errorcounter++}else{Element.hide("mrconschar")}if(pwdlength>0&&login.length>0&&contains(pwd,login)){Element.show("nologinid");addWSSError("nologinid password");errorcounter++}else{Element.hide("nologinid")}if(errorcounter>0){Element.show("example");password=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}if(serverErrors>0){Element.hide("example")}return(false)}else{password=true;if((retypepwd.length!=0&&validateRetypePassword('retypePassword')==false)||errorcounter==0){errorcounter=1;Element.hide("example");return}accept();return}}function validateIndicatorPwd(theField) {var foundAtRate = false;var foundDot = false;var foundSplChar = false;var found4SameChar = false;var pwd = $F('password');var pwdlength = pwd.length;var company = $F('company');var email = $F('email');var firstName = $F('firstName');var lastName = $F('lastName');var login = $F('uid');var retypepwd = $F('retypePassword');var errorcounter = 0;var isPWDCompEmailSame = false;checkAllErrors();Element.hide("required");var strengthIndicator = document.getElementById( 'passwordStrength' );	Element.hide("pwdMetrYellow");Element.hide("pwdMetrGreen");strengthIndicator.className="invalid";var row = document.getElementById("indicatorColorMsg");row.style.display = 'none';if (pwdlength > 0) {for (i = 0; i < pwdlength; i++) {ch = pwd.charAt(i);if (!isLetter(ch) && !isDigit(ch)) {if (ch == '@') {foundAtRate = true} else if (ch == '.') {foundDot = true} else if (ch == ' ') {foundSplChar = true} else if (ch == '~') {foundSplChar = true} else if (ch == '\'') {foundSplChar = true} else if (ch == '"') {foundSplChar = true} else if (ch == '<') {foundSplChar = true} else if (ch == '>') {foundSplChar = true}}if (i >= 3 && !found4SameChar) {if ((ch == pwd.charAt(i - 1)) && (ch == pwd.charAt(i - 2))&& (ch == pwd.charAt(i - 3))) {found4SameChar = true}}}}if ((pwdlength > 0 && pwdlength < 8) || pwdlength < 1) {Element.show("pwdless");addWSSError("empty password");errorcounter++} else {Element.hide("pwdless")}if (pwdlength > 35) {Element.show("pwdlength");addWSSError("invalid password");errorcounter++} else {Element.hide("pwdlength")}if (foundSplChar) {Element.show("charspecial");addWSSError("spchars password");errorcounter++} else {Element.hide("charspecial")}if (found4SameChar) {Element.show("mrconschar");addWSSError("invalidchars password");errorcounter++} else {Element.hide("mrconschar")}if (pwdlength > 0 && login.length > 0 && contains(pwd, login)) {Element.show("nologinid");addWSSError("nologinid password");errorcounter++} else {Element.hide("nologinid")}if (pwdlength > 0 && firstName.length > 0 && contains(pwd, firstName)) {Element.show("indicatornofirstName");addWSSError("nologinid password");errorcounter++} else {Element.hide("indicatornofirstName")}if (pwdlength > 0 && lastName.length > 0 && contains(pwd, lastName)) {Element.show("indicatornolastName");addWSSError("nologinid password");errorcounter++} else {Element.hide("indicatornolastName")}if (pwdlength > 0 && company.length > 0 && contains(pwd, company)) {isPWDCompEmailSame = true;}if (pwdlength > 0 && email.length > 0 && contains(pwd, email)) {isPWDCompEmailSame = true;}if(isPWDCompEmailSame){Element.show("indicatornoemailcompany");addWSSError("nologinid password");errorcounter++} else {Element.hide("indicatornoemailcompany")}	if(!pwd.match("((?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).*$)")){Element.show("alpha");addWSSError("alpha password");errorcounter++} else {Element.hide("alpha")}if (errorcounter > 0) {Element.show("example");password = false;document.forms[0].allvalid.value = "false";if (acceptdisable == true) {accept()}if (serverErrors > 0) {Element.hide("example")}return (false)} else {password = true;if ((retypepwd.length != 0 && validateRetypePassword('retypePassword') == false)|| errorcounter == 0) {errorcounter = 1;Element.hide("example");return}accept();return}}function validateRetypePassword(theField){var retypepwd=$F('retypePassword');var retypepwdLength=retypepwd.length;var pwd=$F('password');var pwdLength=pwd.length;var errorcounter=0;checkAllErrors();if(retypepwdLength==0){Element.show("repwdempty");addWSSError("empty retypepassword");errorcounter++}else{Element.hide("repwdempty")}if(retypepwdLength>0&&retypepwdLength<6){Element.show("reenter");addWSSError("invalid retypepassword");errorcounter++}else{Element.hide("reenter")}if(retypepwd!=pwd){Element.show("mismatch");addWSSError("mismatch retypepassword");errorcounter++}else{Element.hide("mismatch")}if(errorcounter>0){retypepassword=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}return(false)}else{retypepassword=true;accept();return(true)}if(pwd.length==0){Element.hide("required");Element.show("required")}}function validateEmail(theField){var email=$F('email');var pwd=$F('password');var errorcounter=0;checkAllErrors();if((email==null)||(email.length<1)){Element.show("emailempty");addWSSError("empty email");errorcounter++}else{Element.hide("emailempty")}var atSign=email.indexOf("@");var period=email.indexOf(".");if(email.length>0){if(atSign==-1||period==-1){Element.show("emailformat");addWSSError("format email");errorcounter++}else{Element.hide("emailformat")}if(invalidDomain(email)){Element.show("emailinvalid");addWSSError("invalid email");errorcounter++}else{Element.hide("emailinvalid")}if(isInValidEmail(email)){Element.show("emailinvalid");addWSSError("invalid email");errorcounter++}else{Element.hide("emailinvalid")}}if(errorcounter>0){Email=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}return(false)}else{Email=true;accept();return(true)}}function invalidDomain(email){var invalid=false;var atrate=email.indexOf('@');var dot=email.indexOf('.');if(atrate==-1||dot==-1)return true;if(email!=null&&email.length<5&&atrate!=-1&&dot!=-1)return true;var emailId=email.substring(0,atrate);var domain=email.substring(atrate);if(emailId==null||emailId.length<1)return true;if(domain!=null){var multiat=domain.substring(1);if(multiat.indexOf('@')!=-1)return true}dot=domain.indexOf('.');if(dot==-1)return true;var afterdot=domain.substring(dot+1);var dotFlag=true;atrate=1;while(dotFlag){var diff=dot-atrate;if(diff<1)return true;atrate=0;dot=afterdot.indexOf('.');afterdot=afterdot.substring(dot+1);if(dot==-1)dotFlag=false}if(afterdot==null||afterdot.length<1)invalid=true;return invalid}function validateretypeEmail(theField){var retypemail=$F('retypeEmail');var email=$F('email');var errorcounter=0;checkAllErrors();if((retypemail==null)||(retypemail.length<1)){Element.show("reemailempty");addWSSError("empty retypeemail");errorcounter++}else{Element.hide("reemailempty")}if(email.length>0){if((retypemail.length!=0)&&(email.length!=0)&&(retypemail!=email)){Element.show("emailmismatch");addWSSError("mismatch retypeemail");errorcounter++}else{Element.hide("emailmismatch")}}if(errorcounter>0){retypeEmail=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}}else{retypeEmail=true;accept()}if(email==""){Element.show("emailempty")}}function validateFirstName(theField){var firstname=$F('firstName');var nameLength=firstname.length;var foundSplChar=false;var pwd=$F('password');var errorcounter=0;checkAllErrors();if((firstname==null)||(nameLength<1)){Element.show("firstempty");addWSSError("empty firstname");errorcounter++}else{Element.hide("firstempty")}if(nameLength>0){for(i=0;i<nameLength;i++){ch=firstname.charAt(i);if((isLetterOrDigit(ch)==false)&&(ch!=' ')&&(ch!=',')&&(ch!='.')&&(ch!='-')&&(ch!="'")){foundSplChar=true}}if(foundSplChar){Element.show("firstspecialchar");addWSSError("spchars firstname");errorcounter++}else{Element.hide("firstspecialchar")}}if(errorcounter>0){firstName=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}return}else{firstName=true;accept()}}function validateLastName(theField){var lastname=$F('lastName');var nameLength=lastname.length;var foundSplChar=false;var pwd=$F('password');var errorcounter=0;checkAllErrors();if(lastname==null||nameLength==0){Element.show("lastempty");addWSSError("empty lastname");errorcounter++}else{Element.hide("lastempty")}if(lastname!=null&&nameLength>0&&nameLength<2){Element.show("invalidlength");addWSSError("invalid lastname");errorcounter++}else{Element.hide("invalidlength")}if(nameLength>0){for(i=0;i<nameLength;i++){ch=lastname.charAt(i);if((isLetterOrDigit(ch)==false)&&(ch!=' ')&&(ch!='.')&&(ch!='-')&&(ch!="'")){foundSplChar=true}}if(foundSplChar){Element.show("lnspecialchar");addWSSError("spchars lastname");errorcounter++}else{Element.hide("lnspecialchar")}}if(errorcounter>0){lastName=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}}else{lastName=true;accept()}}function validateCity(theField){var city=$F('city');var citylength=city.length;var city1=$F('city1');var citylength1=city1.length;var country;if("true"==document.forms[0].welcomeuser.value){country=document.forms[0].country1.value}else{country=document.forms[0].country.value}country=country.toUpperCase();var errorcounter=0;checkAllErrors();if(country=="AU"){if(city1==""||citylength1==0){Element.show("cityempty");errorcounter++}else{Element.hide("cityempty")}if(citylength1>0&&citylength1<3){Element.show("citylength");errorcounter++}else{Element.hide("citylength")}document.forms[0].city.value=city1}if(country!="AU"){if(city==""||citylength==0){Element.show("cityempty1");addWSSError("empty city");errorcounter++}else{Element.hide("cityempty1")}if(citylength>0&&citylength<3){Element.show("citylength1");addWSSError("invalid city");errorcounter++}else{Element.hide("citylength1")}document.forms[0].city1.value=city}if(errorcounter>0){City=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}}else{City=true;accept()}}function validateAddress(theField){var address=$F('address1');var addresslength=address.length;var errorcounter=0;checkAllErrors();if(address==null||addresslength==0){Element.show("add1empty");addWSSError("empty address1");errorcounter++}else{Element.hide("add1empty")}if(addresslength>0&&addresslength<3){Element.show("add1length");addWSSError("invalid address1");errorcounter++}else{Element.hide("add1length")}if(errorcounter>0){address1=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}}else{address1=true;accept()}}function validateZip(theField){var zip=$F('zip');var country;if("true"==document.forms[0].welcomeuser.value){country=document.forms[0].country1.value}else{country=document.forms[0].country.value}country=country.toLowerCase();var ziplength=zip.length;var allValid=true;var errorcounter=0;checkAllErrors();for(i=0;i<ziplength;i++){ch=zip.charAt(i);if(!isDigit(ch)){allValid=false}}if(country=="us"||country=="pr"||country=="ca"||country=="ca_english"||country=="ca_french"){if(zip==null||ziplength<1){Element.show("zipempty");addWSSError("empty zip");errorcounter++}else{Element.hide("zipempty")}if((country=="us"||country=="")&&((zip>0&&ziplength<5)||ziplength>5||(!allValid))){Element.show("zipinvalid");addWSSError("invalid zip");errorcounter++}else{Element.hide("zipinvalid")}}if(errorcounter>0){Zip=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}}else{Zip=true;accept()}}function validateState(theField){var state=$F('state');var country;if("true"==document.forms[0].welcomeuser.value){country=document.forms[0].country1.value}else{country=document.forms[0].country.value}country=country.toLowerCase();var statelength=state.length;var allValid=true;var errorcounter=0;checkAllErrors();for(i=0;i<statelength;i++){ch=state.charAt(i);if(!isLetter(ch)){allValid=false}}if(country.indexOf("ca_")==0){country=country.substring(0,2)}if((country=="us")||(country=="")||(country=="pr")||(country=="ca")||(country=="ca_english")||(country=="ca_french")){if((statelength>0)&&(statelength<2||!allValid)){Element.show("stateinvalid");addWSSError("invalid state");errorcounter++}else{Element.hide("stateinvalid")}if(state==null||statelength<1){Element.show("stateempty");addWSSError("empty state");errorcounter++}else{Element.hide("stateempty")}}if(errorcounter>0){State=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}}else{State=true;accept()}}function validatePhone(theField){var phone=$F('phone');var country;if("true"==document.forms[0].welcomeuser.value){country=document.forms[0].country1.value}else{country=document.forms[0].country.value}country=country.toUpperCase();var phonelength=phone.length;var errorcounter=0;checkAllErrors();if(phone==null||phonelength<1){Element.show("phonempty");addWSSError("empty phone");errorcounter++}else if(((country=="US")||(country=="PR")||(country=="CA")||(country=="CA_ENGLISH")||(country=="CA_FRENCH"))&&phonelength<10){Element.show("phonempty");addWSSError("empty phone");errorcounter++}else if(!((country=="US")||(country=="PR")||(country=="CA")||(country=="CA_ENGLISH")||(country=="CA_FRENCH"))&&phonelength<3){Element.show("phonempty");addWSSError("empty phone");errorcounter++}else{Element.hide("phonempty")}if(errorcounter>0){Phone=false;document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}}else{Phone=true;accept()}}function validateField(fieldId,elem){var field=$F(fieldId);var fieldname=$(fieldId).name;var pwd=$F('password');var rmdrQuestion=document.forms[0].reminderQuestion.value;var errorcounter=0;checkAllErrors();if((field.search("SP")==-1)&&fieldname=="reminderQuestion"){Element.show(elem);addWSSError("empty question");errorcounter++}if(field.length<2&&field.length!=""&&fieldname=="reminderAnswer"){Element.show("answerlength");addWSSError("length answer");errorcounter++}else{Element.hide("answerlength")}if(field.length==""&&fieldname=="reminderAnswer"){Element.show("answerempty");addWSSError("empty answer");errorcounter++}else{Element.hide("answerempty")}if(fieldId.value==""){Element.show(elem);addWSSError("empty answer");errorcounter++}if(errorcounter>0){if(fieldname=="reminderAnswer"){reminderAnswer=false;if(rmdrQuestion==""||rmdrQuestion==null){Element.show("questionempty")}}if(fieldname=="reminderQuestion"){reminderQuestion=false}if(fieldname=="country"){country=false}if(fieldname=="state"){State=false}document.forms[0].allvalid.value="false";if(acceptdisable==true){accept()}return true}else{if(fieldname=="reminderQuestion"){reminderQuestion=true}if(fieldname=="reminderAnswer"){reminderAnswer=true}if(fieldname=="country"){country=true}if(fieldname=="state"){State=true}Element.hide(elem);accept();return true}}function accept(){var country;if("true"==document.forms[0].welcomeuser.value){country=document.forms[0].country1.value}else{country=document.forms[0].country.value}country=country.toUpperCase();if("true"==document.forms[0].welcomeuser.value){if(firstName&&lastName&&loginId&&password&&retypepassword&&reminderQuestion&&reminderAnswer){acceptdisable=false;document.forms[0].allvalid.value="true"}else{acceptdisable=true;document.forms[0].allvalid.value="false"}}else if(("IN"==country)||(country=="US")||(country=="PR")||(country=="CA")||(country=="CA_ENGLISH")||(country=="CA_FRENCH")){if(loginId&&password&&retypepassword&&reminderQuestion&&reminderAnswer&&address1&&firstName&&lastName&&City&&Phone&&Email&&retypeEmail&&country&&State){acceptdisable=false;document.forms[0].allvalid.value="true"}else{acceptdisable=true;document.forms[0].allvalid.value="false"}}else{if(loginId&&password&&retypepassword&&reminderQuestion&&reminderAnswer&&address1&&firstName&&lastName&&City&&Phone&&Email&&retypeEmail&&country){acceptdisable=false;document.forms[0].allvalid.value="true"}else{acceptdisable=true;document.forms[0].allvalid.value="false"}}}function addWSSError(error){if(self._pec!=undefined){if(contains(self._pec,error))return;}self._pec=error;_hbSet('pec',error);_hbSend();return}function addWSSInfo(name){if(name=='')return;self._ci=name;self._c1=name;_hbSet('customerid',name);_hbSet('c1',name);_hbSend();return}function reloadPage(){serverErrors=document.forms[0].servererrors.value;acceptdisable=true;var valid=document.forms[0].allvalid.value;var uid=document.forms[0].uid.value;if(serverErrors>0){setFieldStats(true);acceptdisable=false;return true}if(serverErrors==0&&valid==true){setFieldStats(true);acceptdisable=false;return true}if(serverErrors==0&&(uid.length>0)){setFieldStats(true);acceptdisable=false;document.forms[0].allvalid.value=="true";return true}else{return false}}function orderCity(){var country;if("true"==document.forms[0].welcomeuser.value){country=document.forms[0].country1.value}else{country=document.forms[0].country.value}country=country.toUpperCase();Element.hide("cityempty1");Element.hide("cityempty");Element.hide("citylength");Element.hide("citylength1");Element.hide("zipempty");Element.hide("zipinvalid");Element.hide("ziplength");Element.hide("stateempty");Element.hide("stateinvalid");if(country=="AU"){show("au");show("au1");show("au2");show("au3");Element.hide("notau1");Element.hide("notau");Element.hide("notau2");if($F('city1')==""){City=false}}else if(country!="AU"&&checkAllErrors()==false){show("notau");show("notau1");Element.show("notau2");hide("au");hide("au1");hide("au2");hide("au3");if($F('city')==""){City=false}}if((country=="US")||(country=="PR")||(country=="CA")||(country=="CA_ENGLISH")||(country=="CA_FRENCH")){if($F('zip')==""){Zip=false}if($F('state')==""){State=false}}if(acceptdisable==true){accept()}return}function setFieldStats(stat){loginId=stat,password=stat,retypepassword=stat,reminderQuestion=stat,reminderAnswer=stat,address1=stat;Zip=stat,State=stat,firstName=stat,lastName=stat,City=stat,Phone=stat,Email=stat,retypeEmail=stat;document.forms[0].allvalid.value=="true"}function contains(str1,str2){var str1=str1.toUpperCase();var str2=str2.toUpperCase();if((str1.search(str2)!=-1)||((str1.indexOf(str2)!=-1)))return true;else return false}function isInValidEmail(str){if(/^[\w-']+(?:\.[\w-']+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/i.test(str)){return false}return true}function isLetter(ch){return(((ch>="a")&&(ch<="z"))||((ch>="A")&&(ch<="Z")))}function isDigit(ch){return((ch>="0")&&(ch<="9"))}function isLetterOrDigit(ch){return(isLetter(ch)||isDigit(ch))}function checkAllErrors(){if(serverErrors>0){setFieldStats(true);acceptdisable=false;document.forms[0].allvalid.value="false";return true}else{return false}}function hideId(){var option1=$F('rb1');var option2=$F('rb2');var userid=$F('uid');if((option1!=null)&&(option1==userid)){Element.hide("idtaken")}if((option2!=null)&&(option2==userid)){Element.hide("idtaken")}}function show(id){if(document.getElementById){document.getElementById(id).style.display="block"}else if(document.all){document.all[id].style.display="block"}else if(document.layers){document.layers[id].display="block"}}function hide(id){if(document.getElementById){document.getElementById(id).style.display="none"}else if(document.all){document.all[id].style.display="none"}else if(document.layers){document.layers[id].display="none"}}function submitForm(){if(document.forms[0].allvalid.value=="false"){acceptdisable=true}else{accept();document.forms[0].submit()}}